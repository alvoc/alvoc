
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://github.com/alvoc/alvoc/constellations/">
      
      
        <link rel="prev" href="../usage/">
      
      
        <link rel="next" href="../reference/">
      
      
      <link rel="icon" href="../assets/icon.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.48">
    
    
      
        <title>Constellations - Alvoc</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../termynal.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#constellations" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Alvoc" class="md-header__button md-logo" aria-label="Alvoc" data-md-component="logo">
      
  <img src="../assets/icon.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Alvoc
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Constellations
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="alvoc" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="blue"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5M7 15a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/alvoc/alvoc" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    alvoc/alvoc
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../usage/" class="md-tabs__link">
        
  
    
  
  Usage

      </a>
    </li>
  

      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
    
  
  Constellations

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../reference/" class="md-tabs__link">
        
  
    
  
  Reference

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../changelog/" class="md-tabs__link">
        
  
    
  
  Changelog

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../dev/" class="md-tabs__link">
        
  
    
  
  Developer

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Alvoc" class="md-nav__button md-logo" aria-label="Alvoc" data-md-component="logo">
      
  <img src="../assets/icon.svg" alt="logo">

    </a>
    Alvoc
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/alvoc/alvoc" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    alvoc/alvoc
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Usage
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Constellations
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Constellations
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-are-constellations" class="md-nav__link">
    <span class="md-ellipsis">
      What are constellations?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="What are constellations?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#constellation-format" class="md-nav__link">
    <span class="md-ellipsis">
      Constellation Format
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generating-an-msa-for-constellation-creation" class="md-nav__link">
    <span class="md-ellipsis">
      Generating an MSA for Constellation Creation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Generating an MSA for Constellation Creation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-collect-reference-sequences" class="md-nav__link">
    <span class="md-ellipsis">
      1. Collect Reference Sequences
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-run-mafft-to-create-the-alignment" class="md-nav__link">
    <span class="md-ellipsis">
      2. Run MAFFT to Create the Alignment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-optional-trim-or-mask-lowconfidence-regions" class="md-nav__link">
    <span class="md-ellipsis">
      3. (Optional) Trim or Mask Low‐Confidence Regions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-validate-the-final-msa" class="md-nav__link">
    <span class="md-ellipsis">
      4. Validate the Final MSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-run-alvoc-constellations-msa" class="md-nav__link">
    <span class="md-ellipsis">
      5. Run alvoc constellations msa
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-tips-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      6. Tips &amp; Best Practices
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reference
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Developer
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-are-constellations" class="md-nav__link">
    <span class="md-ellipsis">
      What are constellations?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="What are constellations?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#constellation-format" class="md-nav__link">
    <span class="md-ellipsis">
      Constellation Format
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generating-an-msa-for-constellation-creation" class="md-nav__link">
    <span class="md-ellipsis">
      Generating an MSA for Constellation Creation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Generating an MSA for Constellation Creation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-collect-reference-sequences" class="md-nav__link">
    <span class="md-ellipsis">
      1. Collect Reference Sequences
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-run-mafft-to-create-the-alignment" class="md-nav__link">
    <span class="md-ellipsis">
      2. Run MAFFT to Create the Alignment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-optional-trim-or-mask-lowconfidence-regions" class="md-nav__link">
    <span class="md-ellipsis">
      3. (Optional) Trim or Mask Low‐Confidence Regions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-validate-the-final-msa" class="md-nav__link">
    <span class="md-ellipsis">
      4. Validate the Final MSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-run-alvoc-constellations-msa" class="md-nav__link">
    <span class="md-ellipsis">
      5. Run alvoc constellations msa
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-tips-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      6. Tips &amp; Best Practices
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="constellations">Constellations</h1>
<h2 id="what-are-constellations">What are constellations?</h2>
<p>A key requirement for the <code>find-lineages</code> command is is a json input file containing lineage-centric data. We use the term "constellations" to convey how lineage-defining mutations are organized. Constellations should include a list of site mutations in nucleotide format.</p>
<h3 id="constellation-format">Constellation Format</h3>
<p>Currently our constellation format looks like this:</p>
<pre><code class="language-json">   {
     &quot;A.23.1&quot;: {
        &quot;lineage&quot;: &quot;A.23.1&quot;,
        &quot;label&quot;: &quot;A.23.1-like&quot;,
        &quot;description&quot;: &quot;A.23.1 lineage defining mutations&quot;,
        &quot;sources&quot;: [],
        &quot;tags&quot;: [
            &quot;A.23.1&quot;
        ],
        &quot;sites&quot;: [
            &quot;C4573T&quot;,
            &quot;C8782T&quot;,
            &quot;C10747T&quot;,
            &quot;G11230T&quot;,
            &quot;G11266T&quot;,
            &quot;G11521T&quot;,
            &quot;C16575T&quot;,
            &quot;C17745T&quot;,
            &quot;C22000T&quot;,
            &quot;C22033A&quot;,
            &quot;G22661T&quot;,
            &quot;G23401T&quot;,
            &quot;C23604G&quot;,
            &quot;T24097C&quot;,
            &quot;T28144C&quot;,
            &quot;G28167A&quot;,
            &quot;G28378C&quot;,
            &quot;G28878A&quot;,
            &quot;G29742A&quot;
        ],
        &quot;note&quot;: &quot;Unique mutations for sublineage&quot;
    },
    ...
   }
</code></pre>
<p>Typically these are going to have to be custom to your experiment, but we provide the <code>constellations</code>command to simplify this procedure. It comes with 2 subcommands for generating constellations, either based on a provided nextstrain tree url, or from a multiple sequence alignment. For most cases, we typically recommend generating your own multiple sequence alignment, since Nexstrain has a limited set of pathogens.In addition, it may not capture all the lineage data necessary for your experiment.</p>
<div class="termy" data-termynal data-ty-macos data-ty-title="bash"><span data-ty="input" data-ty-prompt="$">alvoc constellations </span><span data-ty><br> Usage: alvoc constellations [OPTIONS] COMMAND [ARGS]...                                                     <br><br> Tools to make constellations                                                                                <br><br>╭─ Options ─────────────────────────────────────────────────────────────────────────────────────────────────╮<br>│ --help          Show this message and exit.                                                               │<br>╰───────────────────────────────────────────────────────────────────────────────────────────────────────────╯<br>╭─ Commands ────────────────────────────────────────────────────────────────────────────────────────────────╮<br>│ nextstrain   Generates constellations using the provided nextstrain phylogeny dataset.                    │<br>│ msa          Generates constellations using a custom MSA FASTA file.                                      │<br>╰───────────────────────────────────────────────────────────────────────────────────────────────────────────╯<br></span></div>

<p>Generating constellations from a published Nextstrain tree only requires the url to that tree, but we offer some customizable options. The proportion threshold can be adjusted to determine the proportion of nodes belonging to a clade that must have a mutation for it to be included in the constellation for that clade (default 0.9). We suggest lowering this proportion threshold for trees with clades that have very few nodes. 
Many Nextstrain trees have both clades and subclades, so you can use the <code>--use-subclades</code> flag to switch from the default setting of clades to use only the subclades in the tree.</p>
<pre><code class="language-console">$ alvoc constellations nextstrain

 Usage: alvoc constellations nextstrain [OPTIONS] TREE_URL

 Generates constellations using the provided nextstrain phylogeny dataset.

╭─ Arguments ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ *    tree_url      TEXT  Nextstrain phylogeny tree dataset JSON URL [required]                                                                │
╰───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─ Options ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ --proportion_threshold  -pt      FLOAT  Minimum proportion of nodes in a clade required to include a mutation [default: 0.9]                  │
│ --use-subclades         -s              Use subclades instead of clades for constellation generation                                          │
│ --outdir                -o       TEXT   Output directory for results and intermediate data [default: .]                                       │
│ --help                                  Show this message and exit.                                                                           │
╰───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
</code></pre>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We also provide some <a href="https://github.com/alvoc/alvoc/tree/main/examples">example scripts</a> for Sars-CoV-2 Pango lineage  constellations.</p>
</div>
<h2 id="generating-an-msa-for-constellation-creation">Generating an MSA for Constellation Creation</h2>
<p>When using the <code>alvoc constellations msa</code> subcommand, you need to supply a multiple‐sequence alignment (MSA) in FASTA format that contains all reference genomes (or representative sequences) from the lineages you wish to capture. Below is a step‐by‐step guide for building such an MSA using common tools (e.g., MAFFT), along with recommendations on sequence selection and basic quality checks.</p>
<hr />
<h4 id="1-collect-reference-sequences">1. Collect Reference Sequences</h4>
<ol>
<li>
<p><strong>Decide which genomes to include.</strong>
   Typically, you’ll want:</p>
</li>
<li>
<p>A “reference” genome (e.g., the earliest complete genome for your virus of interest, such as Wuhan‐Hu‐1 for SARS‐CoV‐2).</p>
</li>
<li>One or more representative sequences from each lineage or clade you care about. These can be downloaded from GenBank or GISAID.</li>
<li>
<p>Optional: Include outgroup sequences (closely‐related species/strains) if you want to root the tree.</p>
</li>
<li>
<p><strong>Assemble them into a single FASTA file.</strong>
   For instance, create a file named <code>references.fasta</code> containing entries like:</p>
</li>
</ol>
<p>```fasta</p>
<blockquote>
<p>Wuhan-Hu-1|NC_045512.2
   ATTAAAGGTTT... (complete reference sequence)
LineageA.23.1_rep1|MW123456.1
   ATGTTGGTTT... (sequence from a representative of A.23.1)
LineageB.1.1.7_rep1|MW654321.1
   ATTTAGTGTT... (sequence from B.1.1.7, etc.)
   ```</p>
</blockquote>
<p>Make sure each header is unique and includes enough metadata (accession or lineage name) to identify the sequence later.</p>
<hr />
<h4 id="2-run-mafft-to-create-the-alignment">2. Run MAFFT to Create the Alignment</h4>
<p>MAFFT is a widely‐used aligner for viral genomes because it handles large numbers of sequences quickly and accurately.</p>
<ol>
<li><strong>Install MAFFT</strong> (if not already available). For example, on Ubuntu:</li>
</ol>
<p><code>bash
   sudo apt-get update &amp;&amp; sudo apt-get install mafft</code></p>
<p>Or via conda:</p>
<p><code>bash
   conda install -c bioconda mafft</code></p>
<ol>
<li><strong>Execute MAFFT with sensible parameters.</strong>
   A common invocation for full‐length viral genomes is:</li>
</ol>
<p><code>bash
   mafft --auto references.fasta &gt; references_aligned.fasta</code></p>
<ul>
<li><code>--auto</code> lets MAFFT pick the best algorithm based on your dataset size.</li>
<li>
<p>If you have many (e.g., &gt;100) long genomes, you might replace <code>--auto</code> with <code>--thread 8 --retree 2 --maxiterate 1000</code>. For example:</p>
<p><code>bash
 mafft --thread 8 --retree 2 --maxiterate 1000 references.fasta &gt; references_aligned.fasta</code></p>
</li>
<li>
<p><strong>Inspect the output.</strong>
   Open <code>references_aligned.fasta</code> in any alignment viewer (e.g., AliView, Jalview, or even a text editor) and check that:</p>
</li>
<li>
<p>All sequences have roughly the same length.</p>
</li>
<li>There are no large blocks of gaps at one end (indicative of truncated sequences).</li>
<li>Highly divergent sequences still align sensibly (no spuriously long insertions).</li>
</ul>
<hr />
<h4 id="3-optional-trim-or-mask-lowconfidence-regions">3. (Optional) Trim or Mask Low‐Confidence Regions</h4>
<p>Depending on your downstream analysis and how varied your input set is, you may want to remove poorly aligned regions:</p>
<ol>
<li>
<p><strong>Identify regions with excessive gaps.</strong>
   For example, if more than 50% of sequences have a gap at a given position, you might mask that column.</p>
</li>
<li>
<p><strong>Use a simple script or tool (e.g., trimAl) to perform automated trimming.</strong>
   Example with trimAl:</p>
</li>
</ol>
<p><code>bash
   trimal -in references_aligned.fasta -out references_aligned_trimmed.fasta \
         -automated1</code></p>
<ul>
<li>
<p><code>-automated1</code> applies a default trimming strategy suitable for most alignments.</p>
</li>
<li>
<p><strong>Double‐check your trimmed FASTA.</strong>
   Ensure that no essential genomic regions (e.g., S gene for SARS‐CoV‐2) were accidentally clipped.</p>
</li>
</ul>
<hr />
<h4 id="4-validate-the-final-msa">4. Validate the Final MSA</h4>
<p>Before feeding the MSA into <code>alvoc constellations msa</code>, run a quick sanity check:</p>
<ul>
<li><strong>Sequence lengths should be consistent.</strong></li>
</ul>
<p><code>bash
  awk '/^&gt;/ {if (seqlen){print seqlen}; seqlen=0; next;} {seqlen += length($0);} END{print seqlen}' \
      references_aligned_trimmed.fasta | sort -nu</code></p>
<ul>
<li>
<p>All printed lengths should be the same (or very close if you intentionally kept variable‐length UTRs/gaps).</p>
</li>
<li>
<p><strong>Look for unexpected characters.</strong>
  Make sure there are only <code>A, T, G, C, N, -</code> (and possibly lowercase) in your FASTA. No spurious symbols like <code>*</code> or spaces.</p>
</li>
</ul>
<hr />
<h4 id="5-run-alvoc-constellations-msa">5. Run <code>alvoc constellations msa</code></h4>
<p>Once you have a validated MSA (e.g., <code>references_aligned_trimmed.fasta</code>), call the constellations subcommand. Ensure you specify your header delimeter and clade field index so the algorithm correctly groups your constellations:</p>
<pre><code class="language-bash">alvoc constellations msa \
    references_aligned_trimmed.fasta \
    -o constellations
    -cd '|' \
    -cf 0
</code></pre>
<p>After this runs, you’ll get a directory as specified by the output parameter, containing a <code>constellations.json</code> file that specifies lineage‐specific site mutations derived from your MSA.</p>
<pre><code class="language-sh">constellations/
├── constellations.json
├── constellations.json.sha256
├── constellations.manifest.json
└── lineages.txt
</code></pre>
<p>This JSON can then be passed into <code>alvoc find-lineages</code> or <code>alvoc find-mutants</code>.</p>
<hr />
<h4 id="6-tips-best-practices">6. Tips &amp; Best Practices</h4>
<ul>
<li>
<p><strong>Use a consistent reference sequence.</strong>
  All coordinates in downstream mutation files are referenced against the same genome. If you align to Wuhan‐Hu-1 (NC_045512.2), make sure all coordinates reported by Alvoc are interpretable relative to that locus.</p>
</li>
<li>
<p><strong>Keep your input FASTA headers simple yet unique.</strong>
  Avoid spaces or special characters; use underscores (<code>_</code>) or pipes (<code>|</code>) instead. The <code>--metadata</code> CSV will match on the exact header line (everything after the <code>&gt;</code>), so they must correspond exactly.</p>
</li>
<li>
<p><strong>Document your MSA parameters.</strong>
  If you plan to compare constellations across different runs, note which MAFFT flags (e.g., <code>--auto</code> vs.\ <code>--globalpair</code>) you used. Small differences in alignment can lead to slight shifts in how site mutations are called.</p>
</li>
<li>
<p><strong>Re‐use alignments whenever possible.</strong>
  If you expect to add new lineages or update an existing constellation, simply append new sequences to your old <code>references.fasta</code> and re‐align. You can keep your previous <code>--metadata</code> CSV and only add rows for the new headers.</p>
</li>
</ul>
<hr />












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../usage/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Usage">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Usage
              </div>
            </div>
          </a>
        
        
          
          <a href="../reference/" class="md-footer__link md-footer__link--next" aria-label="Next: Reference">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Reference
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 Alvoc
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.code.annotate", "content.code.copy", "content.tabs.link", "header.autohide", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../termynal.js"></script>
      
        <script src="../js/open_in_new_tab.js"></script>
      
    
  </body>
</html>